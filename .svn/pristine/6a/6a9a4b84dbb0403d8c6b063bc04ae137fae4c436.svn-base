'use strict';
// Class definition
KTDatatableDataLocalDemo
var KTAppOptions = {
    "colors": {
        "state": {
            "brand": "#374afb",
            "light": "#ffffff",
            "dark": "#282a3c",
            "primary": "#5867dd",
            "success": "#34bfa3",
            "info": "#36a3f7",
            "warning": "#ffb822",
            "danger": "#fd3995"
        },
        "base": {
            "label": ["#c5cbe3", "#a1a8c3", "#3d4465", "#3e4466"],
            "shape": ["#f0f3ff", "#d9dffa", "#afb4d4", "#646c9a"]
        }
    }
};

var KTDatatableDataLocalDemo = function() {
    // Private functions

    var demo = function() {

        var datatable = $('.kt-datatable').KTDatatable({
            // datasource definition
            data: {
                type: 'remote',
                // type : 'local',
                // source : dataJSONArray,
                source: {

                    read: {
                        url: 'data.php',
                        map: function(raw) {

                            var dataSet = raw;
                            if (typeof raw.data !== 'undefined') {

                                dataSet = raw.data;
                            }
                            return dataSet;
                        },
                    },

                },
                pageSize: 10, // display 20 records per page
                serverPaging: true,
                serverFiltering: true,
                serverSorting: true,
            },

            // layout definition
            layout: {
                scroll: true, // enable/disable datatable scroll both horizontal and vertical when needed.
                footer: false, // display/hide footer

                class : 'table-striped',
                customScrollbar : false,
            },
            // toolbar
            toolbar: {
                // toolbar placement can be at top or bottom or both top and bottom repeated
                placement: ['top', 'bottom'],

                // toolbar items
                items: {
                    // pagination
                    pagination: {
                        // page size select
                        pageSizeSelect: [5, 10, 20, 30, 50], // display dropdown to select pagination size. -1 is used for "ALl" option
                    },
                },
            },

            rows: {
                autoHide: false,
            },

            // column sorting
            sortable: true,

            pagination: true,



            // columns definition
            columns: [
                {
                    field: 'RecordID',
                    title: '#',
                    sortable: false,
                    width: 20,
                    type: 'number',
                    selector: {class: 'kt-checkbox--solid'},
                    textAlign: 'center',
                }, {
                    field: 'OrderID',
                    title: 'Order ID',
                }, {
                    field: 'Country',
                    title: 'Country',
                    template: function(row) {
                        return row.Country + ' ' + row.ShipCountry;
                    },
                }, {
                    field: 'ShipDate',
                    title: 'Ship Date',
                    type: 'date',
                    format: 'MM/DD/YYYY',
                }, {
                    field: 'CompanyName',
                    title: 'Company Name',
                }, {
                    field: 'Status',
                    title: 'Status',
                    // callback function support for column rendering
                    template: function(row) {
                        var status = {
                            1: {'title': 'Pending', 'class': 'kt-badge--brand'},
                            2: {'title': 'Delivered', 'class': ' kt-badge--danger'},
                            3: {'title': 'Canceled', 'class': ' kt-badge--primary'},
                            4: {'title': 'Success', 'class': ' kt-badge--success'},
                            5: {'title': 'Info', 'class': ' kt-badge--info'},
                            6: {'title': 'Danger', 'class': ' kt-badge--danger'},
                            7: {'title': 'Warning', 'class': ' kt-badge--warning'},
                        };
                        return '<span class="kt-badge ' + status[row.Status].class + ' kt-badge--inline kt-badge--pill">' + status[row.Status].title + '</span>';
                    },
                }, {
                    field: 'Type',
                    title: 'Type',
                    autoHide: false,
                    // callback function support for column rendering
                    template: function(row) {
                        var status = {
                            1: {'title': 'Online', 'state': 'danger'},
                            2: {'title': 'Retail', 'state': 'primary'},
                            3: {'title': 'Direct', 'state': 'success'},
                        };
                        return '<span class="kt-badge kt-badge--' + status[row.Type].state + ' kt-badge--dot"></span>&nbsp;<span class="kt-font-bold kt-font-' + status[row.Type].state +
                            '">' +
                            status[row.Type].title + '</span>';
                    },
                }, {
                    field: 'Actions',
                    title: 'Actions',
                    sortable: false,
                    width: 110,
                    overflow: 'visible',
                    autoHide: false,
                    template: function() {
                        return '\
						<div class="dropdown">\
							<a href="javascript:;" class="btn btn-sm btn-clean btn-icon btn-icon-md" data-toggle="dropdown">\
                                <i class="la la-cog"></i>\
                            </a>\
						  	<div class="dropdown-menu dropdown-menu-right">\
						    	<a class="dropdown-item" href="#"><i class="la la-edit"></i> Edit Details</a>\
						    	<a class="dropdown-item" href="#"><i class="la la-leaf"></i> Update Status</a>\
						    	<a class="dropdown-item" href="#"><i class="la la-print"></i> Generate Report</a>\
						  	</div>\
						</div>\
						<a href="javascript:;" class="btn btn-sm btn-clean btn-icon btn-icon-md" title="Edit details">\
							<i class="la la-edit"></i>\
						</a>\
						<a href="javascript:;" class="btn btn-sm btn-clean btn-icon btn-icon-md" title="Delete">\
							<i class="la la-trash"></i>\
						</a>\
					';
                    },
                }],
        });

    };

    return {
        // Public functions
        init: function() {
            // init dmeo
            demo();
        },
    };
}();

var ThemeSwitcher = function() {
    return {
        init: function() {
            var theme_panel = $(".theme_panel");
            var theme_switcher_left = {
                "day": "0px",
                "night": "25px"
            }
            function switchTheme (theme) {
                $("#theme_style_css").attr("href", "assets/css/themes/" + theme + ".css");
                // if (color == "day")
                //     $(".page-logo img").attr("src", "layouts/layout/img/" + "logo-invert.png");
                // else
                //     $(".page-logo img").attr("src", "layouts/layout/image/" + "logo.png")
            };

            theme_panel.click(function() {
                var theme_styles = $(".theme_style", $(this));
                var active_theme = $(".theme_style:not(.active)");
                var theme = active_theme.attr("theme-style");
                switchTheme(theme);
                theme_styles.removeClass("active");
                active_theme.addClass("active");
                $(".theme_switcher", $(this)).css("left", theme_switcher_left[theme]);
            });
        }
    }
}();

jQuery(document).ready(function() {
    KTDatatableDataLocalDemo.init();

    ThemeSwitcher.init();

    $('#signOut').on('click', function(){

        $.post({

            url: 'logout.php',
            success: function(response, status, xhr, $form) {
                // similate 2s delay

                if(status == "success") {

                    window.location.reload();
                    return ;
                }

                setTimeout(function() {
                    btn.removeClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', false);
                    showErrorMsg(form, 'danger', 'Incorrect username or password. Please try again.');
                }, 2000);
            }
        });
    });
});