
function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c[name.length];
            return c.substring(name.length, c.length);
        }
    }
    return 0;
}

function setCookie(cname, cvalue, exdays=30) {
    var d = new Date();
    // alert(document.cookie);
    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
    var expires = "expires="+d.toUTCString();
    //document.cookie = "username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    // alert(cvalue);
    // alert(document.cookie);
    return getCookie(cname);
}


var ThemeSwitcher = function() {
    return {
        init: function() {
            var theme_panel = $(".theme_panel");
            var mode = getCookie('dispMode');
            // alert(mode);
            var theme_styles = $(".theme_style", $(this));
            var active_theme = $(".theme_style:not(.active)");
            var theme = active_theme.attr("theme-style");


            if(mode == 0) {
                switchTheme(theme);
                theme_styles.removeClass("active");
                active_theme.addClass("active");
            }
            function switchTheme (theme) {
                $("#theme_style_css").attr("href", "assets/css/themes/" + theme + ".css");
            };

            theme_panel.click(function() {
                var theme_styles = $(".theme_style", $(this));
                var active_theme = $(".theme_style:not(.active)");
                var theme = active_theme.attr("theme-style");
                //switchTheme(theme);

                // theme_styles.removeClass("active");
                // active_theme.addClass("active");

                setCookie('dispMode', 1-getCookie('dispMode'), 0);
                // alert(getCookie('dispMode'));
                // alert(1-getCookie('dispMode'));
// return ;
                if (theme == "day") {
                    $(".theme_switcher", $(this)).css("left", "2px"); $(".theme_switcher", $(this)).css("right", "auto");
                } else if (theme == "night") {
                    $(".theme_switcher", $(this)).css("left", "auto"); $(".theme_switcher", $(this)).css("right", "2px");
                }
            });
        }
    }
}();

jQuery(document).ready(function() {

    ThemeSwitcher.init();

    $('#signOut').on('click', function(){

        $.post({

            url: 'logout.php',
            success: function(response, status, xhr, $form) {
                // similate 2s delay

                if(status == "success") {

                    window.location.reload();
                    return ;
                }

                setTimeout(function() {
                    btn.removeClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', false);
                    showErrorMsg(form, 'danger', 'Incorrect username or password. Please try again.');
                }, 2000);
            }
        });
    });
});